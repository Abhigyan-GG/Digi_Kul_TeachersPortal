{% extends 'base.html' %}
{% block title %}Welcome â€¢ Digi Kul{% endblock %}
{% block content %}
<section>
  <h1>Welcome to Digi Kul</h1>
  <p class="muted">A simple portal for teachers and students.</p>
  {% if not session.get('user_id') %}
    <div style="display:flex; gap: .5rem;">
      <a href="/admin_login" role="button">Admin Login</a>
      <a href="/login" role="button">Login</a>
      <a href="/register" role="button" class="secondary">Register</a>
    </div>
  {% else %}
    {% if session.get('user_type') == 'teacher' %}
      <a href="/teacher_dashboard" role="button">Go to Teacher Dashboard</a>
    {% elif session.get('user_type') == 'admin' %}
      <a href="/admin_dashboard" role="button">Go to Admin Dashboard</a>
    {% else %}
      <a href="/student_dashboard" role="button">Go to Student Dashboard</a>
    {% endif %}
  {% endif %}
</section>

<section style="margin-top: 2rem;">
  <div style="background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.06);">
    <h2 style="margin-bottom: .5rem;">DigiKul Highlights</h2>
    <p class="muted" style="margin-bottom: 1rem;">Low-bandwidth e-learning built for reliability.</p>
    <ul style="list-style:none; padding:0; display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: .5rem;">
      <li>âœ“ Audio-first live classes</li>
      <li>âœ“ Adaptive quality</li>
      <li>âœ“ Offline downloads</li>
      <li>âœ“ Device-to-device sharing</li>
      <li>âœ“ Push-to-talk</li>
      <li>âœ“ Real-time chat & quizzes</li>
            </ul>
    <div id="status" class="status offline" style="margin-top: 1rem; padding: .75rem 1rem; border-radius: 8px; background:#f8d7da; color:#721c24; border:1px solid #f5c6cb;">ðŸ”´ Checking server status...</div>
        </div>
</section>

    <script>
  async function checkStatus(){
    try{
      const res = await fetch('/api/health');
      const data = await res.json();
                const statusDiv = document.getElementById('status');
      if(data.status === 'healthy'){
                    statusDiv.className = 'status online';
        statusDiv.style.background = '#d4edda';
        statusDiv.style.color = '#155724';
        statusDiv.style.border = '1px solid #c3e6cb';
                    statusDiv.innerHTML = `ðŸŸ¢ Server Online - Active Sessions: ${data.active_sessions}`;
                } else {
                    statusDiv.className = 'status offline';
        statusDiv.style.background = '#f8d7da';
        statusDiv.style.color = '#721c24';
        statusDiv.style.border = '1px solid #f5c6cb';
                    statusDiv.innerHTML = 'ðŸ”´ Server Offline';
                }
    } catch(e){
                const statusDiv = document.getElementById('status');
                statusDiv.className = 'status offline';
      statusDiv.style.background = '#f8d7da';
      statusDiv.style.color = '#721c24';
      statusDiv.style.border = '1px solid #f5c6cb';
                statusDiv.innerHTML = 'ðŸ”´ Server Offline';
            }
        }
        checkStatus();
        setInterval(checkStatus, 30000);
    </script>
{% endblock %}