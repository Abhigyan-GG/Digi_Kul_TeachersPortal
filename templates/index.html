{% extends 'base.html' %}
{% block title %}{{ get_translation('Welcome', session.get('language', 'en')) }} â€¢ {{ get_translation('Digi Kul', session.get('language', 'en')) }}{% endblock %}
{% block content %}
<div class="card" style="max-width: 800px; margin: 2rem auto;">
  <div class="card-header">
    <h1 class="card-title">{{ get_translation('Welcome to Digi Kul', session.get('language', 'en')) }}</h1>
    <p class="card-subtitle">{{ get_translation('A simple portal for teachers and students', session.get('language', 'en')) }}</p>
  </div>
  <div class="card-body">
    {% if not session.get('user_id') %}
      <div class="flex gap-4 justify-center">
        <a href="/admin_login" class="btn btn-primary">{{ get_translation('Admin Login', session.get('language', 'en')) }}</a>
        <a href="/login" class="btn btn-secondary">{{ get_translation('Login', session.get('language', 'en')) }}</a>
      </div>
    {% else %}
      <div class="text-center">
        {% if session.get('user_type') == 'teacher' %}
          <a href="/teacher_dashboard" class="btn btn-primary btn-lg">{{ get_translation('Go to Teacher Dashboard', session.get('language', 'en')) }}</a>
        {% elif session.get('user_type') == 'admin' %}
          <a href="/admin_dashboard" class="btn btn-primary btn-lg">{{ get_translation('Go to Admin Dashboard', session.get('language', 'en')) }}</a>
        {% else %}
          <a href="/student_dashboard" class="btn btn-primary btn-lg">{{ get_translation('Go to Student Dashboard', session.get('language', 'en')) }}</a>
        {% endif %}
      </div>
    {% endif %}
  </div>
</div>

<div class="card" style="margin-top: 2rem;">
  <div class="card-header">
    <h2 class="card-title">{{ _('DigiKul Highlights') }}</h2>
    <p class="card-subtitle">{{ _('Low-bandwidth e-learning built for reliability') }}</p>
  </div>
  <div class="card-body">
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
      <div class="flex items-center gap-2">
        <span style="color: var(--success); font-size: 1.2rem;">âœ“</span>
        <span>{{ _('Audio-first live classes') }}</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--success); font-size: 1.2rem;">âœ“</span>
        <span>{{ _('Adaptive quality') }}</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--success); font-size: 1.2rem;">âœ“</span>
        <span>{{ _('Offline downloads') }}</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--success); font-size: 1.2rem;">âœ“</span>
        <span>{{ _('Device-to-device sharing') }}</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--success); font-size: 1.2rem;">âœ“</span>
        <span>{{ _('Push-to-talk') }}</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--success); font-size: 1.2rem;">âœ“</span>
        <span>{{ _('Real-time chat & quizzes') }}</span>
      </div>
    </div>
    <div id="status" class="alert error" style="margin-top: 1rem;">{{ _('ðŸ”´ Checking server status...') }}</div>
  </div>
</div>

    <script>
  async function checkStatus(){
    try{
      const res = await fetch('/api/health');
      const data = await res.json();
                const statusDiv = document.getElementById('status');
      if(data.status === 'healthy'){
                    statusDiv.className = 'status online';
        statusDiv.style.background = '#d4edda';
        statusDiv.style.color = '#155724';
        statusDiv.style.border = '1px solid #c3e6cb';
                    statusDiv.innerHTML = `ðŸŸ¢ {{ _('Server Online - Active Sessions: %(sessions)s', sessions='') }}${data.active_sessions}`;
                } else {
                    statusDiv.className = 'status offline';
        statusDiv.style.background = '#f8d7da';
        statusDiv.style.color = '#721c24';
        statusDiv.style.border = '1px solid #f5c6cb';
                    statusDiv.innerHTML = '{{ _("ðŸ”´ Server Offline") }}';
                }
    } catch(e){
                const statusDiv = document.getElementById('status');
                statusDiv.className = 'status offline';
      statusDiv.style.background = '#f8d7da';
      statusDiv.style.color = '#721c24';
      statusDiv.style.border = '1px solid #f5c6cb';
                statusDiv.innerHTML = '{{ _("ðŸ”´ Server Offline") }}';
            }
        }
        checkStatus();
        setInterval(checkStatus, 30000);
    </script>
{% endblock %}